(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const i of l.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function r(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(a){if(a.ep)return;a.ep=!0;const l=r(a);fetch(a.href,l)}})();var ye,P,Qe,Q,Oe,Xe,Ye,Ze,Te,ke,Ce,ae={},et=[],yt=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,be=Array.isArray;function J(t,n){for(var r in n)t[r]=n[r];return t}function Le(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function bt(t,n,r){var s,a,l,i={};for(l in n)l=="key"?s=n[l]:l=="ref"?a=n[l]:i[l]=n[l];if(arguments.length>2&&(i.children=arguments.length>3?ye.call(arguments,2):r),typeof t=="function"&&t.defaultProps!=null)for(l in t.defaultProps)i[l]===void 0&&(i[l]=t.defaultProps[l]);return me(t,i,s,a,null)}function me(t,n,r,s,a){var l={type:t,props:n,key:r,ref:s,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:a??++Qe,__i:-1,__u:0};return a==null&&P.vnode!=null&&P.vnode(l),l}function V(t){return t.children}function ge(t,n){this.props=t,this.context=n}function te(t,n){if(n==null)return t.__?te(t.__,t.__i+1):null;for(var r;n<t.__k.length;n++)if((r=t.__k[n])!=null&&r.__e!=null)return r.__e;return typeof t.type=="function"?te(t):null}function tt(t){var n,r;if((t=t.__)!=null&&t.__c!=null){for(t.__e=t.__c.base=null,n=0;n<t.__k.length;n++)if((r=t.__k[n])!=null&&r.__e!=null){t.__e=t.__c.base=r.__e;break}return tt(t)}}function He(t){(!t.__d&&(t.__d=!0)&&Q.push(t)&&!pe.__r++||Oe!=P.debounceRendering)&&((Oe=P.debounceRendering)||Xe)(pe)}function pe(){for(var t,n,r,s,a,l,i,c=1;Q.length;)Q.length>c&&Q.sort(Ye),t=Q.shift(),c=Q.length,t.__d&&(r=void 0,s=void 0,a=(s=(n=t).__v).__e,l=[],i=[],n.__P&&((r=J({},s)).__v=s.__v+1,P.vnode&&P.vnode(r),$e(n.__P,r,s,n.__n,n.__P.namespaceURI,32&s.__u?[a]:null,l,a??te(s),!!(32&s.__u),i),r.__v=s.__v,r.__.__k[r.__i]=r,at(l,r,i),s.__e=s.__=null,r.__e!=a&&tt(r)));pe.__r=0}function nt(t,n,r,s,a,l,i,c,g,m,y){var o,h,d,p,f,_,v,b=s&&s.__k||et,k=n.length;for(g=xt(r,n,b,g,k),o=0;o<k;o++)(d=r.__k[o])!=null&&(h=d.__i==-1?ae:b[d.__i]||ae,d.__i=o,_=$e(t,d,h,a,l,i,c,g,m,y),p=d.__e,d.ref&&h.ref!=d.ref&&(h.ref&&Me(h.ref,null,d),y.push(d.ref,d.__c||p,d)),f==null&&p!=null&&(f=p),(v=!!(4&d.__u))||h.__k===d.__k?g=rt(d,g,t,v):typeof d.type=="function"&&_!==void 0?g=_:p&&(g=p.nextSibling),d.__u&=-7);return r.__e=f,g}function xt(t,n,r,s,a){var l,i,c,g,m,y=r.length,o=y,h=0;for(t.__k=new Array(a),l=0;l<a;l++)(i=n[l])!=null&&typeof i!="boolean"&&typeof i!="function"?(typeof i=="string"||typeof i=="number"||typeof i=="bigint"||i.constructor==String?i=t.__k[l]=me(null,i,null,null,null):be(i)?i=t.__k[l]=me(V,{children:i},null,null,null):i.constructor===void 0&&i.__b>0?i=t.__k[l]=me(i.type,i.props,i.key,i.ref?i.ref:null,i.__v):t.__k[l]=i,g=l+h,i.__=t,i.__b=t.__b+1,c=null,(m=i.__i=_t(i,r,g,o))!=-1&&(o--,(c=r[m])&&(c.__u|=2)),c==null||c.__v==null?(m==-1&&(a>y?h--:a<y&&h++),typeof i.type!="function"&&(i.__u|=4)):m!=g&&(m==g-1?h--:m==g+1?h++:(m>g?h--:h++,i.__u|=4))):t.__k[l]=null;if(o)for(l=0;l<y;l++)(c=r[l])!=null&&(2&c.__u)==0&&(c.__e==s&&(s=te(c)),lt(c,c));return s}function rt(t,n,r,s){var a,l;if(typeof t.type=="function"){for(a=t.__k,l=0;a&&l<a.length;l++)a[l]&&(a[l].__=t,n=rt(a[l],n,r,s));return n}t.__e!=n&&(s&&(n&&t.type&&!n.parentNode&&(n=te(t)),r.insertBefore(t.__e,n||null)),n=t.__e);do n=n&&n.nextSibling;while(n!=null&&n.nodeType==8);return n}function _t(t,n,r,s){var a,l,i,c=t.key,g=t.type,m=n[r],y=m!=null&&(2&m.__u)==0;if(m===null&&c==null||y&&c==m.key&&g==m.type)return r;if(s>(y?1:0)){for(a=r-1,l=r+1;a>=0||l<n.length;)if((m=n[i=a>=0?a--:l++])!=null&&(2&m.__u)==0&&c==m.key&&g==m.type)return i}return-1}function Ie(t,n,r){n[0]=="-"?t.setProperty(n,r??""):t[n]=r==null?"":typeof r!="number"||yt.test(n)?r:r+"px"}function de(t,n,r,s,a){var l,i;e:if(n=="style")if(typeof r=="string")t.style.cssText=r;else{if(typeof s=="string"&&(t.style.cssText=s=""),s)for(n in s)r&&n in r||Ie(t.style,n,"");if(r)for(n in r)s&&r[n]==s[n]||Ie(t.style,n,r[n])}else if(n[0]=="o"&&n[1]=="n")l=n!=(n=n.replace(Ze,"$1")),i=n.toLowerCase(),n=i in t||n=="onFocusOut"||n=="onFocusIn"?i.slice(2):n.slice(2),t.l||(t.l={}),t.l[n+l]=r,r?s?r.u=s.u:(r.u=Te,t.addEventListener(n,l?Ce:ke,l)):t.removeEventListener(n,l?Ce:ke,l);else{if(a=="http://www.w3.org/2000/svg")n=n.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(n!="width"&&n!="height"&&n!="href"&&n!="list"&&n!="form"&&n!="tabIndex"&&n!="download"&&n!="rowSpan"&&n!="colSpan"&&n!="role"&&n!="popover"&&n in t)try{t[n]=r??"";break e}catch{}typeof r=="function"||(r==null||r===!1&&n[4]!="-"?t.removeAttribute(n):t.setAttribute(n,n=="popover"&&r==1?"":r))}}function Fe(t){return function(n){if(this.l){var r=this.l[n.type+t];if(n.t==null)n.t=Te++;else if(n.t<r.u)return;return r(P.event?P.event(n):n)}}}function $e(t,n,r,s,a,l,i,c,g,m){var y,o,h,d,p,f,_,v,b,k,A,F,D,q,O,j,H,C=n.type;if(n.constructor!==void 0)return null;128&r.__u&&(g=!!(32&r.__u),l=[c=n.__e=r.__e]),(y=P.__b)&&y(n);e:if(typeof C=="function")try{if(v=n.props,b="prototype"in C&&C.prototype.render,k=(y=C.contextType)&&s[y.__c],A=y?k?k.props.value:y.__:s,r.__c?_=(o=n.__c=r.__c).__=o.__E:(b?n.__c=o=new C(v,A):(n.__c=o=new ge(v,A),o.constructor=C,o.render=Nt),k&&k.sub(o),o.state||(o.state={}),o.__n=s,h=o.__d=!0,o.__h=[],o._sb=[]),b&&o.__s==null&&(o.__s=o.state),b&&C.getDerivedStateFromProps!=null&&(o.__s==o.state&&(o.__s=J({},o.__s)),J(o.__s,C.getDerivedStateFromProps(v,o.__s))),d=o.props,p=o.state,o.__v=n,h)b&&C.getDerivedStateFromProps==null&&o.componentWillMount!=null&&o.componentWillMount(),b&&o.componentDidMount!=null&&o.__h.push(o.componentDidMount);else{if(b&&C.getDerivedStateFromProps==null&&v!==d&&o.componentWillReceiveProps!=null&&o.componentWillReceiveProps(v,A),n.__v==r.__v||!o.__e&&o.shouldComponentUpdate!=null&&o.shouldComponentUpdate(v,o.__s,A)===!1){for(n.__v!=r.__v&&(o.props=v,o.state=o.__s,o.__d=!1),n.__e=r.__e,n.__k=r.__k,n.__k.some(function(I){I&&(I.__=n)}),F=0;F<o._sb.length;F++)o.__h.push(o._sb[F]);o._sb=[],o.__h.length&&i.push(o);break e}o.componentWillUpdate!=null&&o.componentWillUpdate(v,o.__s,A),b&&o.componentDidUpdate!=null&&o.__h.push(function(){o.componentDidUpdate(d,p,f)})}if(o.context=A,o.props=v,o.__P=t,o.__e=!1,D=P.__r,q=0,b){for(o.state=o.__s,o.__d=!1,D&&D(n),y=o.render(o.props,o.state,o.context),O=0;O<o._sb.length;O++)o.__h.push(o._sb[O]);o._sb=[]}else do o.__d=!1,D&&D(n),y=o.render(o.props,o.state,o.context),o.state=o.__s;while(o.__d&&++q<25);o.state=o.__s,o.getChildContext!=null&&(s=J(J({},s),o.getChildContext())),b&&!h&&o.getSnapshotBeforeUpdate!=null&&(f=o.getSnapshotBeforeUpdate(d,p)),j=y,y!=null&&y.type===V&&y.key==null&&(j=st(y.props.children)),c=nt(t,be(j)?j:[j],n,r,s,a,l,i,c,g,m),o.base=n.__e,n.__u&=-161,o.__h.length&&i.push(o),_&&(o.__E=o.__=null)}catch(I){if(n.__v=null,g||l!=null)if(I.then){for(n.__u|=g?160:128;c&&c.nodeType==8&&c.nextSibling;)c=c.nextSibling;l[l.indexOf(c)]=null,n.__e=c}else{for(H=l.length;H--;)Le(l[H]);Se(n)}else n.__e=r.__e,n.__k=r.__k,I.then||Se(n);P.__e(I,n,r)}else l==null&&n.__v==r.__v?(n.__k=r.__k,n.__e=r.__e):c=n.__e=vt(r.__e,n,r,s,a,l,i,g,m);return(y=P.diffed)&&y(n),128&n.__u?void 0:c}function Se(t){t&&t.__c&&(t.__c.__e=!0),t&&t.__k&&t.__k.forEach(Se)}function at(t,n,r){for(var s=0;s<r.length;s++)Me(r[s],r[++s],r[++s]);P.__c&&P.__c(n,t),t.some(function(a){try{t=a.__h,a.__h=[],t.some(function(l){l.call(a)})}catch(l){P.__e(l,a.__v)}})}function st(t){return typeof t!="object"||t==null||t.__b&&t.__b>0?t:be(t)?t.map(st):J({},t)}function vt(t,n,r,s,a,l,i,c,g){var m,y,o,h,d,p,f,_=r.props||ae,v=n.props,b=n.type;if(b=="svg"?a="http://www.w3.org/2000/svg":b=="math"?a="http://www.w3.org/1998/Math/MathML":a||(a="http://www.w3.org/1999/xhtml"),l!=null){for(m=0;m<l.length;m++)if((d=l[m])&&"setAttribute"in d==!!b&&(b?d.localName==b:d.nodeType==3)){t=d,l[m]=null;break}}if(t==null){if(b==null)return document.createTextNode(v);t=document.createElementNS(a,b,v.is&&v),c&&(P.__m&&P.__m(n,l),c=!1),l=null}if(b==null)_===v||c&&t.data==v||(t.data=v);else{if(l=l&&ye.call(t.childNodes),!c&&l!=null)for(_={},m=0;m<t.attributes.length;m++)_[(d=t.attributes[m]).name]=d.value;for(m in _)if(d=_[m],m!="children"){if(m=="dangerouslySetInnerHTML")o=d;else if(!(m in v)){if(m=="value"&&"defaultValue"in v||m=="checked"&&"defaultChecked"in v)continue;de(t,m,null,d,a)}}for(m in v)d=v[m],m=="children"?h=d:m=="dangerouslySetInnerHTML"?y=d:m=="value"?p=d:m=="checked"?f=d:c&&typeof d!="function"||_[m]===d||de(t,m,d,_[m],a);if(y)c||o&&(y.__html==o.__html||y.__html==t.innerHTML)||(t.innerHTML=y.__html),n.__k=[];else if(o&&(t.innerHTML=""),nt(n.type=="template"?t.content:t,be(h)?h:[h],n,r,s,b=="foreignObject"?"http://www.w3.org/1999/xhtml":a,l,i,l?l[0]:r.__k&&te(r,0),c,g),l!=null)for(m=l.length;m--;)Le(l[m]);c||(m="value",b=="progress"&&p==null?t.removeAttribute("value"):p!=null&&(p!==t[m]||b=="progress"&&!p||b=="option"&&p!=_[m])&&de(t,m,p,_[m],a),m="checked",f!=null&&f!=t[m]&&de(t,m,f,_[m],a))}return t}function Me(t,n,r){try{if(typeof t=="function"){var s=typeof t.__u=="function";s&&t.__u(),s&&n==null||(t.__u=t(n))}else t.current=n}catch(a){P.__e(a,r)}}function lt(t,n,r){var s,a;if(P.unmount&&P.unmount(t),(s=t.ref)&&(s.current&&s.current!=t.__e||Me(s,null,n)),(s=t.__c)!=null){if(s.componentWillUnmount)try{s.componentWillUnmount()}catch(l){P.__e(l,n)}s.base=s.__P=null}if(s=t.__k)for(a=0;a<s.length;a++)s[a]&&lt(s[a],n,r||typeof t.type!="function");r||Le(t.__e),t.__c=t.__=t.__e=void 0}function Nt(t,n,r){return this.constructor(t,r)}function wt(t,n,r){var s,a,l,i;n==document&&(n=document.documentElement),P.__&&P.__(t,n),a=(s=!1)?null:n.__k,l=[],i=[],$e(n,t=n.__k=bt(V,null,[t]),a||ae,ae,n.namespaceURI,a?null:n.firstChild?ye.call(n.childNodes):null,l,a?a.__e:n.firstChild,s,i),at(l,t,i)}ye=et.slice,P={__e:function(t,n,r,s){for(var a,l,i;n=n.__;)if((a=n.__c)&&!a.__)try{if((l=a.constructor)&&l.getDerivedStateFromError!=null&&(a.setState(l.getDerivedStateFromError(t)),i=a.__d),a.componentDidCatch!=null&&(a.componentDidCatch(t,s||{}),i=a.__d),i)return a.__E=a}catch(c){t=c}throw t}},Qe=0,ge.prototype.setState=function(t,n){var r;r=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=J({},this.state),typeof t=="function"&&(t=t(J({},r),this.props)),t&&J(r,t),t!=null&&this.__v&&(n&&this._sb.push(n),He(this))},ge.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),He(this))},ge.prototype.render=V,Q=[],Xe=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Ye=function(t,n){return t.__v.__b-n.__v.__b},pe.__r=0,Ze=/(PointerCapture)$|Capture$/i,Te=0,ke=Fe(!1),Ce=Fe(!0);var kt=0;function e(t,n,r,s,a,l){n||(n={});var i,c,g=n;if("ref"in g)for(c in g={},n)c=="ref"?i=n[c]:g[c]=n[c];var m={type:t,props:g,key:r,ref:i,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--kt,__i:-1,__u:0,__source:a,__self:l};if(typeof t=="function"&&(i=t.defaultProps))for(c in i)g[c]===void 0&&(g[c]=i[c]);return P.vnode&&P.vnode(m),m}var se,L,we,Be,le=0,ot=[],$=P,Re=$.__b,Ue=$.__r,We=$.diffed,ze=$.__c,qe=$.unmount,Ge=$.__;function Ee(t,n){$.__h&&$.__h(L,t,le||n),le=0;var r=L.__H||(L.__H={__:[],__h:[]});return t>=r.__.length&&r.__.push({}),r.__[t]}function x(t){return le=1,Ct(dt,t)}function Ct(t,n,r){var s=Ee(se++,2);if(s.t=t,!s.__c&&(s.__=[dt(void 0,n),function(c){var g=s.__N?s.__N[0]:s.__[0],m=s.t(g,c);g!==m&&(s.__N=[m,s.__[1]],s.__c.setState({}))}],s.__c=L,!L.__f)){var a=function(c,g,m){if(!s.__c.__H)return!0;var y=s.__c.__H.__.filter(function(h){return!!h.__c});if(y.every(function(h){return!h.__N}))return!l||l.call(this,c,g,m);var o=s.__c.props!==c;return y.forEach(function(h){if(h.__N){var d=h.__[0];h.__=h.__N,h.__N=void 0,d!==h.__[0]&&(o=!0)}}),l&&l.call(this,c,g,m)||o};L.__f=!0;var l=L.shouldComponentUpdate,i=L.componentWillUpdate;L.componentWillUpdate=function(c,g,m){if(this.__e){var y=l;l=void 0,a(c,g,m),l=y}i&&i.call(this,c,g,m)},L.shouldComponentUpdate=a}return s.__N||s.__}function z(t,n){var r=Ee(se++,3);!$.__s&&ct(r.__H,n)&&(r.__=t,r.u=n,L.__H.__h.push(r))}function X(t){return le=5,it(function(){return{current:t}},[])}function it(t,n){var r=Ee(se++,7);return ct(r.__H,n)&&(r.__=t(),r.__H=n,r.__h=t),r.__}function w(t,n){return le=8,it(function(){return t},n)}function St(){for(var t;t=ot.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(he),t.__H.__h.forEach(Pe),t.__H.__h=[]}catch(n){t.__H.__h=[],$.__e(n,t.__v)}}$.__b=function(t){L=null,Re&&Re(t)},$.__=function(t,n){t&&n.__k&&n.__k.__m&&(t.__m=n.__k.__m),Ge&&Ge(t,n)},$.__r=function(t){Ue&&Ue(t),se=0;var n=(L=t.__c).__H;n&&(we===L?(n.__h=[],L.__h=[],n.__.forEach(function(r){r.__N&&(r.__=r.__N),r.u=r.__N=void 0})):(n.__h.forEach(he),n.__h.forEach(Pe),n.__h=[],se=0)),we=L},$.diffed=function(t){We&&We(t);var n=t.__c;n&&n.__H&&(n.__H.__h.length&&(ot.push(n)!==1&&Be===$.requestAnimationFrame||((Be=$.requestAnimationFrame)||Pt)(St)),n.__H.__.forEach(function(r){r.u&&(r.__H=r.u),r.u=void 0})),we=L=null},$.__c=function(t,n){n.some(function(r){try{r.__h.forEach(he),r.__h=r.__h.filter(function(s){return!s.__||Pe(s)})}catch(s){n.some(function(a){a.__h&&(a.__h=[])}),n=[],$.__e(s,r.__v)}}),ze&&ze(t,n)},$.unmount=function(t){qe&&qe(t);var n,r=t.__c;r&&r.__H&&(r.__H.__.forEach(function(s){try{he(s)}catch(a){n=a}}),r.__H=void 0,n&&$.__e(n,r.__v))};var Je=typeof requestAnimationFrame=="function";function Pt(t){var n,r=function(){clearTimeout(s),Je&&cancelAnimationFrame(n),setTimeout(t)},s=setTimeout(r,35);Je&&(n=requestAnimationFrame(r))}function he(t){var n=L,r=t.__c;typeof r=="function"&&(t.__c=void 0,r()),L=n}function Pe(t){var n=L;t.__c=t.__(),L=n}function ct(t,n){return!t||t.length!==n.length||n.some(function(r,s){return r!==t[s]})}function dt(t,n){return typeof n=="function"?n(t):n}function jt(){const n=window.location.pathname.match(/^\/project\/([^/]+)/);return n?`/project/${n[1]}/api`:"/api"}const je=jt();async function S(t,n){return(await fetch(`${je}${t}`,{...n,headers:{"Content-Type":"application/json",...n?.headers}})).json()}function Tt(){const[t,n]=x(null),[r,s]=x(!1),a=w(async()=>{s(!0);try{const c=await S("/board");n(c)}finally{s(!1)}},[]),l=w(async c=>{await S("/task",{method:"POST",body:JSON.stringify(c)}),await a()},[a]),i=w(async(c,g)=>{await S(`/task/${c}/move`,{method:"POST",body:JSON.stringify({status:g})}),await a()},[a]);return{board:t,loading:r,refresh:a,createTask:l,moveTask:i}}function Lt(){const[t,n]=x([]),[r,s]=x(!1),[a,l]=x(null),i=w(async()=>{const y=await S("/chat/history");n(y.messages||[])},[]),c=w(async y=>{const o={role:"user",content:y};n(d=>[...d,o]),s(!0);const h=new AbortController;l(h);try{const f={role:"assistant",content:(await(await fetch(`${je}/chat`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:y}),signal:h.signal})).json()).response};n(_=>[..._,f])}catch(d){if(d.name==="AbortError"){const p={role:"assistant",content:"*(Stopped)*"};n(f=>[...f,p])}else{const p={role:"error",content:"Error: Could not reach Claude"};n(f=>[...f,p])}}finally{s(!1),l(null)}},[]),g=w(()=>{a&&(a.abort(),fetch(`${je}/chat/stop`,{method:"POST"}).catch(()=>{}))},[a]),m=w(async()=>{await S("/chat/history",{method:"DELETE"}),n([])},[]);return{messages:t,loading:r,loadHistory:i,sendMessage:c,stopGeneration:g,clearHistory:m}}function $t(){const[t,n]=x([]),[r,s]=x(""),a=w(async()=>{const i=await S("/projects");n(i.projects||[]);const c=i.projects?.find(g=>g.current);c&&s(c.name)},[]),l=w(async i=>{const c=await S("/projects/switch",{method:"POST",body:JSON.stringify({path:i})});return c.success&&s(c.project),c.success},[]);return{projects:t,currentProject:r,load:a,switchProject:l}}function ut(){const[t,n]=x([]),r=w(async()=>{const g=await S("/claude/mcp");n(g.servers||[])},[]),s=w(async g=>{await S("/claude/mcp",{method:"POST",body:JSON.stringify(g)}),await r()},[r]),a=w(async(g,m)=>{await S(`/claude/mcp/${g}`,{method:"PUT",body:JSON.stringify(m)}),await r()},[r]),l=w(async(g,m)=>{await S(`/claude/mcp/${g}`,{method:"DELETE",body:JSON.stringify({scope:m})}),await r()},[r]),i=w(async(g,m,y)=>{await S(`/claude/mcp/${g}/toggle`,{method:"POST",body:JSON.stringify({scope:m,enabled:y})}),await r()},[r]),c=w(async(g,m)=>{try{return await S(`/claude/mcp/${g}?scope=${m}`)}catch{return null}},[]);return{servers:t,load:r,add:s,update:a,remove:l,toggle:i,getOne:c}}function Mt(){const[t,n]=x([]),r=w(async()=>{const c=await S("/claude/skills");n(c.skills||[])},[]),s=w(async c=>{await S("/claude/skills",{method:"POST",body:JSON.stringify(c)}),await r()},[r]),a=w(async c=>(await S(`/claude/skills${c}`)).content||"",[]),l=w(async(c,g)=>{await S(`/claude/skills${c}`,{method:"PUT",body:JSON.stringify({content:g})}),await r()},[r]),i=w(async c=>{await S(`/claude/skills${c}`,{method:"DELETE"}),await r()},[r]);return{skills:t,load:r,create:s,getContent:a,updateContent:l,remove:i}}function Et(){const[t,n]=x([]),r=w(async()=>{const l=await S("/claude/tools");n(l.tools||[])},[]),s=w(async(l,i)=>{await S(`/claude/tools/${l}/toggle`,{method:"POST",body:JSON.stringify({enabled:i,scope:"project"})}),await r()},[r]),a=w(async l=>{try{return await S(`/claude/tools/${l}`)}catch{return null}},[]);return{tools:t,load:r,toggle:s,getDetails:a}}function At(){const[t,n]=x([]),r=w(async()=>{const i=await S("/claude/hooks");n(i.hooks||[])},[]),s=w(async i=>{await S("/claude/hooks",{method:"POST",body:JSON.stringify(i)}),await r()},[r]),a=w(async(i,c)=>{await S("/claude/hooks",{method:"PUT",body:JSON.stringify({old_event:i.event,old_command:i.command,old_scope:i.scope,event:c.event,command:c.command,scope:c.scope})}),await r()},[r]),l=w(async(i,c,g)=>{await S("/claude/hooks",{method:"DELETE",body:JSON.stringify({event:i,command:c,scope:g})}),await r()},[r]);return{hooks:t,load:r,add:s,update:a,remove:l}}function Dt(){const[t,n]=x("main"),r=w(async()=>{const s=await S("/git/branch");n(s.branch||"main")},[]);return{branch:t,loadBranch:r}}function Ot(){return{ping:w(async()=>await S("/session/ping",{method:"POST"}),[])}}function Ht(){const[t,n]=x([]),[r,s]=x(!1),a=w(async()=>{s(!0);try{const h=await(await fetch("/api/manager/projects")).json();n(h.projects||[])}catch(o){console.error("Failed to load managed projects:",o)}finally{s(!1)}},[]),l=w(async(o,h)=>{const p=await(await fetch("/api/manager/projects",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:o,git_url:h})})).json();return p.success&&await a(),p},[a]),i=w(async o=>{const d=await(await fetch(`/api/manager/projects/${o}`,{method:"DELETE"})).json();return d.success&&await a(),d},[a]),c=w(async o=>{const d=await(await fetch(`/api/manager/projects/${o}/start`,{method:"POST"})).json();return await a(),d},[a]),g=w(async o=>{const d=await(await fetch(`/api/manager/projects/${o}/stop`,{method:"POST"})).json();return await a(),d},[a]),m=w(o=>{window.open(`/project/${o}/`,"_blank")},[]),y=w(async(o,h)=>{const p=await(await fetch(`/api/manager/projects/${o}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(h)})).json();return p.success&&await a(),p},[a]);return{managedProjects:t,loading:r,loadProjects:a,createProject:l,deleteProject:i,startProject:c,stopProject:g,openProject:m,updateProject:y}}function It(){const[t,n]=x(null),[r,s]=x(!1),[a,l]=x(null),i=w(async()=>{s(!0),l(null);try{const c=await S("/agents");n(c)}catch(c){l(c.message)}finally{s(!1)}},[]);return{agents:t,loading:r,error:a,load:i}}function Ft(){const[t,n]=x(null),[r,s]=x(!1),[a,l]=x(null),i=w(async()=>{s(!0),l(null);try{const c=await fetch("/api/manager/health/system");if(!c.ok)throw new Error("Failed to fetch health");const g=await c.json();n(g)}catch(c){l(c.message)}finally{s(!1)}},[]);return{health:t,loading:r,error:a,refresh:i}}function Bt(){const[t,n]=x([]),[r,s]=x("all"),[a,l]=x(!1),[i,c]=x(!0),[g,m]=x(!1),y=X(null),o=w(async _=>{l(!0);try{const b=await S(`/logs?filter=${_??r}`);n(b.logs||[])}catch(v){console.error("Failed to load logs:",v)}finally{l(!1)}},[r]),h=w(async()=>{try{await S("/logs",{method:"DELETE"}),n([])}catch(_){console.error("Failed to clear logs:",_)}},[]),d=w(_=>{s(_),o(_)},[o]),p=w(()=>{y.current||(m(!0),y.current=window.setInterval(()=>{o()},2e3))},[o]),f=w(()=>{y.current&&(clearInterval(y.current),y.current=null),m(!1)},[]);return z(()=>()=>{y.current&&clearInterval(y.current)},[]),{logs:t,filter:r,loading:a,autoScroll:i,polling:g,load:o,clear:h,changeFilter:d,setAutoScroll:c,startPolling:p,stopPolling:f}}function Rt({task:t,onClick:n,onDragStart:r}){return e("div",{className:"bg-gray-700 rounded-lg p-3 cursor-pointer hover:bg-gray-600 active:bg-gray-500 transition-colors touch-manipulation",draggable:!0,onDragStart:s=>r(s,t.id),onClick:n,children:[e("div",{className:"flex items-start justify-between gap-2",children:[e("span",{className:"font-medium text-sm",children:t.name}),t.priority>50&&e("span",{className:"text-xs bg-red-500/20 text-red-400 px-1.5 py-0.5 rounded",children:"High"})]}),t.description&&e("p",{className:"text-xs text-gray-400 mt-1 line-clamp-2",children:t.description}),t.test_cases&&t.test_cases.length>0&&e("div",{className:"text-xs text-gray-500 mt-2",children:[t.test_cases.length," tests"]})]})}function B({isOpen:t,onClose:n,title:r,children:s}){return t?e("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:n,children:e("div",{className:"bg-gray-800 rounded-xl p-5 w-full max-w-md max-h-[90vh] overflow-y-auto",onClick:a=>a.stopPropagation(),children:[e("div",{className:"flex justify-between items-start mb-4",children:[e("h3",{className:"text-lg font-semibold",children:r}),e("button",{onClick:n,className:"text-gray-500 hover:text-gray-300 p-1 -mr-1",children:"âœ•"})]}),s]})}):null}function Ut({isOpen:t,onClose:n,children:r}){return t?e("div",{className:"fixed inset-0 bg-black/50 flex items-end justify-center z-50",onClick:n,children:e("div",{className:"bg-gray-800 rounded-t-2xl w-full max-w-lg p-4 safe-bottom",onClick:s=>s.stopPropagation(),children:[e("div",{className:"w-12 h-1 bg-gray-600 rounded-full mx-auto mb-4"}),r]})}):null}const Wt=[{id:"pending",key:"todo",label:"To Do",color:"bg-gray-500"},{id:"in_progress",key:"in_progress",label:"In Progress",color:"bg-blue-500"},{id:"needs_review",key:"review",label:"Review",color:"bg-yellow-500"},{id:"passing",key:"done",label:"Done",color:"bg-green-500"}];function zt({data:t,onMoveTask:n,onAddTask:r,onWorkOnTask:s}){const[a,l]=x(!1),[i,c]=x(null),[g,m]=x({name:"",description:"",testCases:""}),[y,o]=x(null),h=(b,k)=>{b.dataTransfer?.setData("taskId",k)},d=(b,k)=>{b.preventDefault(),o(k)},p=(b,k)=>{b.preventDefault(),o(null);const A=b.dataTransfer?.getData("taskId");A&&n(A,k)},f=b=>{b.preventDefault(),r({name:g.name,description:g.description,test_cases:g.testCases.split(`
`).filter(k=>k.trim()),priority:0}),m({name:"",description:"",testCases:""}),l(!1)},_=b=>t?.board?t.board[b]||[]:[],v=b=>_(b).length;return e("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e("div",{className:"flex-1 overflow-x-auto overflow-y-auto kanban-scroll p-4",children:e("div",{className:"flex md:grid md:grid-cols-4 gap-3 min-w-max md:min-w-0",children:Wt.map(b=>e("div",{className:`w-72 md:w-auto bg-gray-800 rounded-lg p-3 flex-shrink-0 ${y===b.id?"ring-2 ring-blue-500":""}`,onDragOver:k=>d(k,b.id),onDragLeave:()=>o(null),onDrop:k=>p(k,b.id),children:[e("h2",{className:"font-semibold text-gray-300 mb-3 flex items-center gap-2 text-sm",children:[e("span",{className:`w-2.5 h-2.5 ${b.color} rounded-full`}),b.label,e("span",{className:"text-xs bg-gray-700 px-2 py-0.5 rounded-full",children:v(b.key)})]}),e("div",{className:"space-y-2 min-h-[150px]",children:_(b.key).map(k=>e(Rt,{task:k,onClick:()=>c(k),onDragStart:h},k.id))})]},b.id))})}),e("div",{className:"p-4 border-t border-gray-700 flex-shrink-0 safe-bottom",children:e("button",{onClick:()=>l(!0),className:"w-full md:w-auto px-4 py-3 bg-blue-600 rounded-lg hover:bg-blue-500 active:bg-blue-700 text-sm font-medium",children:"+ Add Task"})}),e(B,{isOpen:a,onClose:()=>l(!1),title:"Add New Task",children:e("form",{onSubmit:f,children:[e("div",{className:"space-y-4",children:[e("div",{children:[e("label",{className:"block text-sm text-gray-400 mb-1",children:"Name"}),e("input",{type:"text",value:g.name,onInput:b=>m({...g,name:b.target.value}),required:!0,className:"w-full bg-gray-700 rounded-lg px-3 py-3 text-base focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e("div",{children:[e("label",{className:"block text-sm text-gray-400 mb-1",children:"Description"}),e("textarea",{value:g.description,onInput:b=>m({...g,description:b.target.value}),rows:3,className:"w-full bg-gray-700 rounded-lg px-3 py-3 text-base focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e("div",{children:[e("label",{className:"block text-sm text-gray-400 mb-1",children:"Test Cases (one per line)"}),e("textarea",{value:g.testCases,onInput:b=>m({...g,testCases:b.target.value}),rows:3,placeholder:`Test case 1
Test case 2`,className:"w-full bg-gray-700 rounded-lg px-3 py-3 text-base focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),e("div",{className:"flex gap-2 mt-6",children:[e("button",{type:"button",onClick:()=>l(!1),className:"flex-1 px-4 py-3 bg-gray-700 rounded-lg hover:bg-gray-600",children:"Cancel"}),e("button",{type:"submit",className:"flex-1 px-4 py-3 bg-blue-600 rounded-lg hover:bg-blue-500",children:"Add"})]})]})}),e(B,{isOpen:!!i,onClose:()=>c(null),title:i?.name||"",children:i&&e(V,{children:[e("div",{className:"space-y-4",children:[e("div",{children:[e("label",{className:"text-xs text-gray-500",children:"Status"}),e("p",{className:"text-sm",children:i.status})]}),i.description&&e("div",{children:[e("label",{className:"text-xs text-gray-500",children:"Description"}),e("p",{className:"text-sm",children:i.description})]}),i.test_cases&&i.test_cases.length>0&&e("div",{children:[e("label",{className:"text-xs text-gray-500",children:"Test Cases"}),e("ul",{className:"text-sm list-disc list-inside",children:i.test_cases.map((b,k)=>e("li",{children:b},k))})]})]}),e("div",{className:"flex gap-2 mt-6",children:[e("button",{onClick:()=>c(null),className:"flex-1 px-4 py-3 bg-gray-700 rounded-lg hover:bg-gray-600",children:"Close"}),e("button",{onClick:()=>{s(i),c(null)},className:"flex-1 px-4 py-3 bg-blue-600 rounded-lg hover:bg-blue-500",children:"Work on this"})]})]})})]})}function fe({checked:t,onChange:n,disabled:r}){return e("label",{className:"relative inline-flex items-center cursor-pointer",children:[e("input",{type:"checkbox",checked:t,onChange:s=>n(s.target.checked),disabled:r,className:"sr-only peer"}),e("div",{className:"w-9 h-5 bg-gray-600 peer-focus:ring-2 peer-focus:ring-blue-500 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-blue-600"})]})}const Ve=6;function qt({messages:t,loading:n,branch:r,onSend:s,onStop:a,onClear:l,onShowAddTask:i,isVisible:c}){const[g,m]=x(""),[y,o]=x(!1),[h,d]=x(!1),[p,f]=x(!1),[_,v]=x(!1),[b,k]=x([]),[A,F]=x(!1),D=Math.max(0,t.length-Ve),q=D>0?t.slice(-Ve):t,O=X(null),j=X(null),H=X(null),C=ut(),I=C.servers.filter(N=>N.enabled).length;z(()=>{C.load()},[]),z(()=>{O.current&&(O.current.scrollTop=O.current.scrollHeight)},[t,b]),z(()=>{c&&O.current&&(O.current.scrollTop=O.current.scrollHeight)},[c]);const U=async()=>{try{const T=await(await fetch("/api/logs?limit=100")).json();k(T.logs||[])}catch(N){console.error("Failed to load debug logs:",N)}};z(()=>(h?(F(!0),U().finally(()=>F(!1)),H.current=window.setInterval(U,3e3)):H.current&&(clearInterval(H.current),H.current=null),()=>{H.current&&clearInterval(H.current)}),[h]);const Y=()=>{const N=j.current;N&&(N.style.height="auto",N.style.height=Math.min(N.scrollHeight,200)+"px")},oe=()=>{const N=g.trim();!N||n||(s(N),m(""),j.current&&(j.current.style.height="auto"))},xe=N=>{N.key==="Enter"&&!N.shiftKey&&(N.preventDefault(),oe())},G=N=>{s(N)},ie=N=>{let T=N.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");return T=T.replace(/```(\w*)\n?([\s\S]*?)```/g,(Ae,De,Ne)=>`<pre class="bg-gray-900 rounded p-3 my-2 overflow-x-auto text-xs font-mono"><code>${Ne.trim()}</code></pre>`),T=T.replace(/`([^`]+)`/g,'<code class="bg-gray-900 px-1.5 py-0.5 rounded text-xs font-mono">$1</code>'),T=T.replace(/\*\*([^*]+)\*\*/g,"<strong>$1</strong>"),T=T.replace(/\*([^*]+)\*/g,"<em>$1</em>"),T=T.replace(/\n/g,"<br>"),T},_e=N=>{try{return new Date(N).toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"})}catch{return N}},ve={info:"text-blue-400",warn:"text-yellow-400",error:"text-red-400",debug:"text-gray-500"};return e("div",{className:"flex flex-col h-full",children:[e("div",{className:"bg-gray-800 rounded-xl mx-3 mt-3 p-3 flex items-center justify-between flex-shrink-0 sticky top-0 z-10",children:[e("div",{className:"flex-1 min-w-0 flex items-center gap-2",children:[e("p",{className:"text-sm text-gray-300 truncate",children:r}),e("button",{onClick:()=>f(!p),className:`px-2 py-1 text-xs rounded-full flex items-center gap-1 transition-colors ${p?"bg-green-600/30 text-green-400 border border-green-500/50":C.servers.length>0?"bg-gray-700 text-gray-400 hover:bg-gray-600":"bg-gray-700 text-gray-500 hover:bg-gray-600"}`,title:`${I}/${C.servers.length} MCP servers enabled`,children:[e("span",{className:`w-2 h-2 rounded-full ${I>0?"bg-green-400":"bg-gray-500"}`}),"MCPs ",C.servers.length>0&&e("span",{className:"text-gray-500",children:["(",I,"/",C.servers.length,")"]})]}),e("button",{onClick:()=>d(!h),className:`px-2 py-1 text-xs rounded-full flex items-center gap-1 transition-colors ${h?"bg-purple-600/30 text-purple-400 border border-purple-500/50":"bg-gray-700 text-gray-400 hover:bg-gray-600"}`,title:h?"Hide debug logs":"Show debug logs",children:[e("span",{className:`w-2 h-2 rounded-full ${h?"bg-purple-400 animate-pulse":"bg-gray-500"}`}),"Debug"]})]}),e("button",{onClick:()=>G("Create a PR for current changes"),className:"ml-2 px-3 py-1 text-sm font-medium hover:bg-gray-700 rounded",children:"View PR"}),e("button",{onClick:()=>o(!0),className:"ml-1 p-1.5 hover:bg-gray-700 rounded",children:e("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:e("path",{d:"M10 6a2 2 0 110-4 2 2 0 010 4zM10 12a2 2 0 110-4 2 2 0 010 4zM10 18a2 2 0 110-4 2 2 0 010 4z"})})})]}),p&&e("div",{className:"mx-3 mt-2 bg-gray-800/80 backdrop-blur rounded-xl border border-green-500/30 overflow-hidden",children:[e("div",{className:"p-3 border-b border-gray-700 flex items-center justify-between",children:[e("span",{className:"text-sm font-medium text-green-400",children:"MCP Servers"}),e("button",{onClick:()=>f(!1),className:"text-gray-400 hover:text-white p-1",children:e("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e("div",{className:"p-3 space-y-2 max-h-48 overflow-y-auto",children:C.servers.length===0?e("div",{className:"text-sm text-gray-500 text-center py-2",children:["No MCP servers configured",e("div",{className:"text-xs mt-1",children:"Add servers in the Tools tab"})]}):C.servers.map(N=>e("div",{className:"flex items-center justify-between p-2 bg-gray-900/50 rounded-lg",children:[e("div",{className:"flex-1 min-w-0 mr-3",children:[e("div",{className:"text-sm font-medium truncate",children:N.name}),e("div",{className:"text-xs text-gray-500 truncate",children:[N.scope," â€¢ ",N.command," ",N.args?.join(" ")]})]}),e(fe,{checked:N.enabled,onChange:T=>C.toggle(N.name,N.scope,T)})]},`${N.scope}-${N.name}`))})]}),e("div",{ref:O,className:"flex-1 min-h-0 overflow-y-auto p-4 space-y-3",children:[t.length===0&&!h?e("div",{className:"text-gray-500 text-sm text-center py-8",children:"Start a conversation with Claude"}):e(V,{children:[D>0&&e("button",{onClick:()=>v(!0),className:"w-full py-2 px-4 text-sm text-gray-400 hover:text-white bg-gray-800/50 hover:bg-gray-800 rounded-lg transition-colors flex items-center justify-center gap-2",children:[e("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})}),"See ",D," earlier message",D>1?"s":""]}),q.map((N,T)=>e("div",{className:N.role==="user"?"bg-blue-600 rounded-lg p-3 ml-4 md:ml-8":N.role==="error"?"bg-red-600/20 text-red-400 rounded-lg p-3":"bg-gray-700 rounded-lg p-3 mr-4 md:mr-8",children:e("div",{className:"text-sm chat-content",dangerouslySetInnerHTML:{__html:ie(N.content)}})},`msg-${D+T}`))]}),h&&e("div",{className:"border-t border-purple-500/30 pt-3 mt-3",children:[e("div",{className:"flex items-center justify-between mb-2",children:[e("span",{className:"text-xs text-purple-400 font-medium flex items-center gap-1",children:[e("span",{className:"w-2 h-2 rounded-full bg-purple-400 animate-pulse"}),"Claude Debug Logs",A&&e("span",{className:"text-gray-500 ml-1",children:"(loading...)"})]}),e("span",{className:"text-xs text-gray-500",children:[b.length," entries"]})]}),e("div",{className:"space-y-1 font-mono text-xs bg-gray-950 rounded-lg p-2 max-h-64 overflow-y-auto",children:b.length===0?e("div",{className:"text-gray-500 text-center py-4",children:"No debug logs yet"}):b.map(N=>e("div",{className:"flex items-start gap-2 py-0.5 hover:bg-gray-800/50 rounded px-1",children:[e("span",{className:"text-gray-600 flex-shrink-0",children:_e(N.timestamp)}),e("span",{className:`flex-shrink-0 ${ve[N.level]||"text-gray-400"}`,children:["[",N.level.toUpperCase().slice(0,4),"]"]}),e("span",{className:"text-gray-300 break-all",children:N.message})]},N.id))})]}),n&&e("div",{className:"bg-gray-700 rounded-lg p-3 mr-4 md:mr-8",children:e("div",{className:"flex gap-1",children:[e("span",{className:"w-2 h-2 bg-gray-400 rounded-full loading-dot"}),e("span",{className:"w-2 h-2 bg-gray-400 rounded-full loading-dot"}),e("span",{className:"w-2 h-2 bg-gray-400 rounded-full loading-dot"})]})})]}),e("div",{className:"p-3 flex-shrink-0 safe-bottom sticky bottom-0 bg-gray-900 z-10",children:e("div",{className:"bg-gray-800 rounded-xl p-3",children:[e("textarea",{ref:j,value:g,onInput:N=>{m(N.target.value),Y()},onKeyDown:xe,placeholder:"Add feedback...",rows:1,className:"w-full bg-transparent text-base focus:outline-none resize-none overflow-y-auto",style:{minHeight:"24px",maxHeight:"200px"}}),e("div",{className:"flex items-center justify-between mt-3 pt-3 border-t border-gray-700",children:[e("div",{className:"flex items-center gap-1",children:e("span",{className:"text-xs bg-gray-700 px-2 py-1 rounded-full text-gray-400",children:"StreetsDigital/vibes"})}),e("div",{className:"flex items-center gap-1",children:[e("button",{onClick:i,className:"p-2 hover:bg-gray-700 rounded-lg active:bg-gray-600",title:"Add task",children:e("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),e("button",{onClick:()=>G("/commit"),className:"p-2 hover:bg-gray-700 rounded-lg active:bg-gray-600",title:"Commit",children:e("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e("button",{onClick:()=>G("Create a pull request"),className:"p-2 hover:bg-gray-700 rounded-lg active:bg-gray-600",title:"Create PR",children:e("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})})}),n?e("button",{onClick:a,className:"p-2 bg-red-500 text-white rounded-lg hover:bg-red-600 active:bg-red-700 ml-1",title:"Stop",children:e("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:e("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8 7a1 1 0 00-1 1v4a1 1 0 001 1h4a1 1 0 001-1V8a1 1 0 00-1-1H8z",clipRule:"evenodd"})})}):e("button",{onClick:oe,className:"p-2 bg-white text-gray-900 rounded-lg hover:bg-gray-200 active:bg-gray-300 ml-1",title:"Send",children:e("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:e("path",{d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z"})})})]})]})]})}),e(Ut,{isOpen:y,onClose:()=>o(!1),children:e("div",{className:"space-y-1",children:[e("button",{onClick:()=>{G("Summarize current tasks"),o(!1)},className:"w-full text-left px-4 py-3 hover:bg-gray-700 rounded-lg",children:"Summarize tasks"}),e("button",{onClick:()=>{G("What should I work on next?"),o(!1)},className:"w-full text-left px-4 py-3 hover:bg-gray-700 rounded-lg",children:"Suggest next task"}),e("button",{onClick:()=>{G("/verify"),o(!1)},className:"w-full text-left px-4 py-3 hover:bg-gray-700 rounded-lg",children:"Run quality checks"}),e("button",{onClick:()=>{G("Show git status"),o(!1)},className:"w-full text-left px-4 py-3 hover:bg-gray-700 rounded-lg",children:"Git status"}),e("button",{onClick:()=>{l(),v(!1),o(!1)},className:"w-full text-left px-4 py-3 hover:bg-gray-700 rounded-lg text-red-400",children:"Clear chat history"}),e("button",{onClick:()=>o(!1),className:"w-full text-left px-4 py-3 text-gray-400 hover:bg-gray-700 rounded-lg",children:"Cancel"})]})}),e(B,{isOpen:_,onClose:()=>v(!1),title:"Chat History",children:e("div",{className:"space-y-3 max-h-[70vh] overflow-y-auto",children:t.map((N,T)=>e("div",{className:N.role==="user"?"bg-blue-600 rounded-lg p-3 ml-4":N.role==="error"?"bg-red-600/20 text-red-400 rounded-lg p-3":"bg-gray-700 rounded-lg p-3 mr-4",children:e("div",{className:"text-sm chat-content",dangerouslySetInnerHTML:{__html:ie(N.content)}})},`modal-msg-${T}`))})})]})}function Gt({isOpen:t,onClose:n}){const[r,s]=x(""),[a,l]=x(null),[i,c]=x(!1),[g,m]=x(""),y=async h=>{if(h.preventDefault(),!!r.trim()){c(!0),m(""),l(null);try{const d=await fetch("/api/config/route",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:r.trim()})});if(!d.ok)throw new Error("Failed to route configuration request");const p=await d.json();l(p)}catch(d){m(d.message)}finally{c(!1)}}},o=h=>{navigator.clipboard.writeText(h),alert(`File path copied to clipboard: ${h}`)};return t?e("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e("div",{className:"bg-gray-900 rounded-lg p-6 w-full max-w-2xl max-h-[80vh] overflow-auto",children:[e("div",{className:"flex items-center justify-between mb-4",children:[e("h2",{className:"text-lg font-semibold text-gray-100",children:"Configuration Helper"}),e("button",{onClick:n,className:"text-gray-400 hover:text-gray-300",children:e("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e("div",{className:"space-y-4",children:[e("div",{children:[e("p",{className:"text-sm text-gray-400 mb-3",children:"Describe what you want to configure, and I'll route you to the right file."}),e("form",{onSubmit:y,children:e("div",{className:"flex space-x-2",children:[e("input",{type:"text",value:r,onInput:h=>s(h.target.value),placeholder:"e.g., change quality gate settings, add MCP server, configure git hooks...",className:"flex-1 px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-gray-100 placeholder-gray-500 focus:outline-none focus:border-blue-500"}),e("button",{type:"submit",disabled:i||!r.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:i?"Routing...":"Find Config"})]})})]}),g&&e("div",{className:"p-3 bg-red-900/20 border border-red-600/30 rounded-lg text-red-400 text-sm",children:g}),a&&e("div",{className:"space-y-3",children:[e("div",{className:"p-4 bg-gray-800 rounded-lg",children:[e("div",{className:"flex items-center justify-between mb-2",children:[e("h3",{className:"text-sm font-medium text-gray-200",children:"Configuration File"}),e("button",{onClick:()=>o(a.file_path),className:"text-xs px-2 py-1 bg-blue-600/20 text-blue-400 rounded hover:bg-blue-600/30",children:"Open File"})]}),e("div",{className:"space-y-2",children:[e("div",{children:[e("span",{className:"text-xs text-gray-500",children:"File Path:"}),e("div",{className:"text-sm font-mono text-gray-300 bg-gray-700/50 px-2 py-1 rounded",children:a.file_path})]}),a.section&&e("div",{children:[e("span",{className:"text-xs text-gray-500",children:"Section:"}),e("div",{className:"text-sm text-gray-300",children:a.section})]}),e("div",{children:[e("span",{className:"text-xs text-gray-500",children:"Description:"}),e("div",{className:"text-sm text-gray-300",children:a.description})]}),a.suggested_change&&e("div",{children:[e("span",{className:"text-xs text-gray-500",children:"Suggested Change:"}),e("div",{className:"text-sm text-gray-300 bg-gray-700/50 px-2 py-1 rounded",children:a.suggested_change})]})]})]}),e("div",{className:"text-xs text-gray-500",children:"ðŸ’¡ Tip: The file path has been provided above. You can edit the file directly or use Claude to make the changes."})]}),e("div",{className:"pt-2",children:[e("h4",{className:"text-sm font-medium text-gray-400 mb-2",children:"Common Configurations:"}),e("div",{className:"grid grid-cols-2 gap-2",children:["quality gates settings","MCP server configuration","git hooks setup","Claude settings","Docker configuration","build scripts"].map(h=>e("button",{onClick:()=>s(h),className:"text-left px-2 py-1 text-xs bg-gray-800 rounded hover:bg-gray-700 text-gray-400 hover:text-gray-300",children:h},h))})]})]})]})}):null}function Jt(){const t=ut(),n=Mt(),r=Et(),s=At(),a=It(),[l,i]=x(!1),[c,g]=x(!1),[m,y]=x(!1),[o,h]=x(!1),[d,p]=x(null),[f,_]=x(null),[v,b]=x(null),[k,A]=x(null),[F,D]=x({}),[q,O]=x({}),[j,H]=x({name:"",command:"",args:"",scope:"project"}),[C,I]=x({name:"",description:"",trigger:"",solution:"",scope:"project"}),[U,Y]=x({event:"PreToolUse",command:"",scope:"project"});z(()=>{t.load(),n.load(),r.load(),s.load(),a.load()},[]);const oe=async u=>{u.preventDefault(),await t.add({name:j.name,command:j.command,args:j.args.split(" ").filter(M=>M),scope:j.scope}),H({name:"",command:"",args:"",scope:"project"}),i(!1)},xe=async u=>{const M=await t.getOne(u.name,u.scope);M&&p(M)},G=async u=>{u.preventDefault(),d&&(await t.update(d.name,d),p(null))},ie=async()=>{!d||!confirm(`Delete MCP server "${d.name}"?`)||(await t.remove(d.name,d.scope),p(null))},_e=async u=>{u.preventDefault(),await n.create(C),I({name:"",description:"",trigger:"",solution:"",scope:"project"}),g(!1)},ve=async u=>{const M=await n.getContent(u.file);_({skill:u,content:M})},N=async u=>{u.preventDefault(),f&&(await n.updateContent(f.skill.file,f.content),_(null))},T=async()=>{!f||!confirm(`Delete skill "${f.skill.name}"?`)||(await n.remove(f.skill.file),_(null))},Ae=async u=>{const M=await r.getDetails(u.name);M&&b(M)},De=async u=>{u.preventDefault(),await s.add(U),Y({event:"PreToolUse",command:"",scope:"project"}),y(!1)},Ne=u=>{A(u)},mt=async()=>{!k||!confirm(`Delete hook "${k.event}"?`)||(await s.remove(k.event,k.command,k.scope),A(null))},ce=async(u,M)=>{D(R=>({...R,[u]:"loading"})),O(R=>({...R,[u]:""}));try{await M(),D(R=>({...R,[u]:"success"})),setTimeout(()=>{D(R=>({...R,[u]:"idle"}))},3e3)}catch(R){D(K=>({...K,[u]:"error"})),O(K=>({...K,[u]:R.message})),setTimeout(()=>{D(K=>({...K,[u]:"idle"})),O(K=>({...K,[u]:""}))},5e3)}},gt=()=>{ce("commit",async()=>{if(!(await fetch("/api/skills/commit",{method:"POST"})).ok)throw new Error("Failed to commit changes")})},ht=()=>{ce("pr",async()=>{if(!(await fetch("/api/git/create-pr",{method:"POST"})).ok)throw new Error("Failed to create PR")})},pt=()=>{ce("quality",async()=>{if(!(await fetch("/api/quality/check",{method:"POST"})).ok)throw new Error("Quality checks failed")})},ft=()=>{ce("retrospective",async()=>{if(!(await fetch("/api/skills/retrospective",{method:"POST"})).ok)throw new Error("Failed to extract learnings")})};return e("div",{className:"flex-1 overflow-y-auto",children:[e("div",{className:"p-4 border-b border-gray-700",children:[e("h2",{className:"font-semibold text-gray-300",children:"Claude Tools"}),e("p",{className:"text-xs text-gray-500",children:"MCP servers, skills, and settings"})]}),e(ne,{title:"MCP Servers",onAdd:()=>i(!0),isEmpty:t.servers.length===0,emptyText:"No MCP servers configured",children:t.servers.map(u=>e(Ke,{title:u.name,subtitle:`${u.scope} â€¢ ${u.command}`,checked:u.enabled,onToggle:M=>t.toggle(u.name,u.scope,M),onClick:()=>xe(u)},`${u.scope}-${u.name}`))}),e(ne,{title:"Skills",onAdd:()=>g(!0),isEmpty:n.skills.length===0,emptyText:"No skills created yet",children:n.skills.map(u=>e("div",{className:"p-2 bg-gray-800 rounded-lg cursor-pointer hover:bg-gray-700",onClick:()=>ve(u),children:[e("div",{className:"text-sm font-medium",children:u.name}),e("div",{className:"text-xs text-gray-500",children:u.description||u.scope})]},u.file))}),e(ne,{title:"Built-in Tools",isEmpty:r.tools.length===0,children:r.tools.map(u=>e(Ke,{title:u.name,subtitle:u.description,checked:u.enabled,onToggle:M=>r.toggle(u.name,M),onClick:()=>Ae(u)},u.name))}),e(ne,{title:"Hooks",onAdd:()=>y(!0),isEmpty:s.hooks.length===0,emptyText:"No hooks configured",children:s.hooks.map((u,M)=>e("div",{className:"flex items-center justify-between p-2 bg-gray-800 rounded-lg cursor-pointer hover:bg-gray-700",onClick:()=>Ne(u),children:[e("div",{className:"flex-1 min-w-0",children:[e("div",{className:"text-sm font-medium",children:u.event}),e("div",{className:"text-xs text-gray-500 truncate",children:[u.scope," â€¢ ",u.command]})]}),e("button",{onClick:R=>{R.stopPropagation(),s.remove(u.event,u.command,u.scope)},className:"ml-2 p-1 text-red-400 hover:text-red-300",children:e("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},M))}),e(ne,{title:"Agents",isEmpty:!a.agents||a.agents.subagents.length===0&&a.agents.polecats.length===0&&a.agents.containers.length===0,emptyText:"No active agents",children:[a.agents&&e("div",{className:"space-y-2",children:[a.agents.subagents.map(u=>e("div",{className:"p-2 bg-gray-800 rounded-lg",children:e("div",{className:"flex items-center justify-between",children:[e("div",{className:"flex-1 min-w-0",children:[e("div",{className:"text-sm font-medium truncate",children:u.feature_name||u.id}),e("div",{className:"text-xs text-gray-500",children:["Subagent â€¢ ",Math.round(u.duration),"s â€¢ ",u.status]})]}),e("div",{className:`w-2 h-2 rounded-full ${u.status==="running"?"bg-green-400":u.status==="complete"?"bg-blue-400":"bg-yellow-400"}`})]})},u.id)),a.agents.polecats.map(u=>e("div",{className:"p-2 bg-gray-800 rounded-lg",children:e("div",{className:"flex items-center justify-between",children:[e("div",{className:"flex-1 min-w-0",children:[e("div",{className:"text-sm font-medium truncate",children:["Polecat ",u.id]}),e("div",{className:"text-xs text-gray-500",children:["Machine ",u.machine_id," â€¢ Convoy ",u.convoy_id]})]}),e("div",{className:"text-xs text-gray-400",children:u.status})]})},u.id)),a.agents.containers.map(u=>e("div",{className:"p-2 bg-gray-800 rounded-lg",children:e("div",{className:"flex items-center justify-between",children:[e("div",{className:"flex-1 min-w-0",children:[e("div",{className:"text-sm font-medium truncate",children:u.name}),e("div",{className:"text-xs text-gray-500",children:["Container â€¢ Project ",u.project_id]})]}),e("div",{className:"text-xs text-gray-400",children:u.status})]})},u.name))]}),a.loading&&e("div",{className:"text-sm text-gray-500",children:"Loading agents..."}),a.error&&e("div",{className:"text-sm text-red-400",children:["Error: ",a.error]})]}),e("div",{className:"p-4",children:[e("h3",{className:"text-sm font-medium text-gray-400 mb-3",children:"Quick Actions"}),e("div",{className:"space-y-2",children:[e(ue,{onClick:gt,label:"Commit changes",state:F.commit||"idle",error:q.commit}),e(ue,{onClick:ht,label:"Create PR",state:F.pr||"idle",error:q.pr}),e(ue,{onClick:pt,label:"Run quality checks",state:F.quality||"idle",error:q.quality}),e(ue,{onClick:ft,label:"Extract learnings",state:F.retrospective||"idle",error:q.retrospective}),e("button",{onClick:()=>h(!0),className:"w-full text-left px-3 py-2 bg-gray-800 rounded-lg hover:bg-gray-700 text-sm flex items-center justify-between",children:[e("span",{children:"Configuration Helper"}),e("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})]})]})]}),e(B,{isOpen:l,onClose:()=>i(!1),title:"Add MCP Server",children:e("form",{onSubmit:oe,children:[e(re,{children:[e(E,{label:"Name",children:e("input",{type:"text",value:j.name,onInput:u=>H({...j,name:u.target.value}),required:!0,placeholder:"my-server",className:"form-input"})}),e(E,{label:"Command",children:e("input",{type:"text",value:j.command,onInput:u=>H({...j,command:u.target.value}),required:!0,placeholder:"npx",className:"form-input"})}),e(E,{label:"Arguments (space separated)",children:e("input",{type:"text",value:j.args,onInput:u=>H({...j,args:u.target.value}),placeholder:"-y @modelcontextprotocol/server-github",className:"form-input"})}),e(E,{label:"Scope",children:e("select",{value:j.scope,onChange:u=>H({...j,scope:u.target.value}),className:"form-input",children:[e("option",{value:"project",children:"Project"}),e("option",{value:"global",children:"Global"})]})})]}),e(Z,{onCancel:()=>i(!1),submitLabel:"Add"})]})}),e(B,{isOpen:!!d,onClose:()=>p(null),title:"MCP Server",children:d&&e("form",{onSubmit:G,children:[e(re,{children:[e(E,{label:"Name",children:e("input",{type:"text",value:d.name,onInput:u=>p({...d,name:u.target.value}),className:"form-input"})}),e(E,{label:"Command",children:e("input",{type:"text",value:d.command,onInput:u=>p({...d,command:u.target.value}),className:"form-input"})}),e(E,{label:"Arguments",children:e("input",{type:"text",value:d.args.join(" "),onInput:u=>p({...d,args:u.target.value.split(" ").filter(M=>M)}),className:"form-input"})}),e("div",{className:"flex items-center justify-between",children:[e("span",{className:"text-sm text-gray-400",children:"Enabled"}),e(fe,{checked:d.enabled,onChange:u=>p({...d,enabled:u})})]}),e("div",{className:"text-xs text-gray-500",children:["Scope: ",d.scope]})]}),e(Z,{onCancel:()=>p(null),onDelete:ie,submitLabel:"Save"})]})}),e(B,{isOpen:c,onClose:()=>g(!1),title:"Create Skill",children:e("form",{onSubmit:_e,children:[e(re,{children:[e(E,{label:"Name",children:e("input",{type:"text",value:C.name,onInput:u=>I({...C,name:u.target.value}),required:!0,placeholder:"fix-common-error",className:"form-input"})}),e(E,{label:"Description",children:e("input",{type:"text",value:C.description,onInput:u=>I({...C,description:u.target.value}),placeholder:"What this skill does",className:"form-input"})}),e(E,{label:"Trigger (when to use)",children:e("textarea",{value:C.trigger,onInput:u=>I({...C,trigger:u.target.value}),rows:2,placeholder:"When error X occurs...",className:"form-input"})}),e(E,{label:"Solution",children:e("textarea",{value:C.solution,onInput:u=>I({...C,solution:u.target.value}),rows:4,placeholder:"Steps to fix...",className:"form-input"})})]}),e(Z,{onCancel:()=>g(!1),submitLabel:"Create"})]})}),e(B,{isOpen:!!f,onClose:()=>_(null),title:f?.skill.name||"",children:f&&e("form",{onSubmit:N,children:[e(re,{children:[e(E,{label:"Content",children:e("textarea",{value:f.content,onInput:u=>_({...f,content:u.target.value}),rows:12,className:"form-input font-mono text-sm"})}),e("div",{className:"text-xs text-gray-500",children:["Path: ",f.skill.file]})]}),e(Z,{onCancel:()=>_(null),onDelete:T,submitLabel:"Save"})]})}),e(B,{isOpen:!!v,onClose:()=>b(null),title:v?.name||"",children:v&&e("div",{className:"space-y-4",children:[e("div",{children:[e("label",{className:"block text-sm text-gray-400 mb-1",children:"Description"}),e("p",{className:"text-sm",children:v.description})]}),e("div",{children:[e("label",{className:"block text-sm text-gray-400 mb-1",children:"Details"}),e("p",{className:"text-sm text-gray-300",children:v.details||"No additional details available."})]}),e("div",{className:"flex items-center justify-between p-3 bg-gray-700 rounded-lg",children:[e("span",{className:"text-sm",children:"Enabled"}),e(fe,{checked:v.enabled,onChange:u=>{r.toggle(v.name,u),b({...v,enabled:u})}})]}),v.denied_in&&e("div",{className:"text-xs text-yellow-400",children:["Disabled in ",v.denied_in," settings"]}),e("button",{onClick:()=>b(null),className:"w-full px-4 py-3 bg-gray-700 rounded-lg hover:bg-gray-600",children:"Close"})]})}),e(B,{isOpen:m,onClose:()=>y(!1),title:"Add Hook",children:e("form",{onSubmit:De,children:[e(re,{children:[e(E,{label:"Event",children:e("select",{value:U.event,onChange:u=>Y({...U,event:u.target.value}),className:"form-input",children:[e("option",{value:"PreToolUse",children:"PreToolUse - Before tool runs"}),e("option",{value:"PostToolUse",children:"PostToolUse - After tool runs"}),e("option",{value:"Notification",children:"Notification - On notifications"}),e("option",{value:"Stop",children:"Stop - When Claude stops"})]})}),e(E,{label:"Command",children:e("input",{type:"text",value:U.command,onInput:u=>Y({...U,command:u.target.value}),required:!0,placeholder:"npm run lint",className:"form-input"})}),e(E,{label:"Scope",children:e("select",{value:U.scope,onChange:u=>Y({...U,scope:u.target.value}),className:"form-input",children:[e("option",{value:"project",children:"Project"}),e("option",{value:"global",children:"Global"})]})})]}),e(Z,{onCancel:()=>y(!1),submitLabel:"Add"})]})}),e(B,{isOpen:!!k,onClose:()=>A(null),title:"Hook",children:k&&e("div",{className:"space-y-4",children:[e(E,{label:"Event",children:e("p",{className:"text-sm",children:k.event})}),e(E,{label:"Command",children:e("p",{className:"text-sm font-mono bg-gray-700 p-2 rounded",children:k.command})}),e(E,{label:"Scope",children:e("p",{className:"text-sm",children:k.scope})}),e(Z,{onCancel:()=>A(null),onDelete:mt,submitLabel:""})]})}),e(Gt,{isOpen:o,onClose:()=>h(!1)})]})}function ne({title:t,onAdd:n,isEmpty:r,emptyText:s,children:a}){return e("div",{className:"p-4 border-b border-gray-700",children:[e("div",{className:"flex items-center justify-between mb-3",children:[e("h3",{className:"text-sm font-medium text-gray-400",children:t}),n&&e("button",{onClick:n,className:"text-xs px-2 py-1 bg-gray-700 rounded hover:bg-gray-600",children:"+ Add"})]}),e("div",{className:"space-y-2",children:r?e("div",{className:"text-sm text-gray-500",children:s}):a})]})}function Ke({title:t,subtitle:n,checked:r,onToggle:s,onClick:a}){return e("div",{className:"flex items-center justify-between p-2 bg-gray-800 rounded-lg cursor-pointer hover:bg-gray-700",children:[e("div",{className:"flex-1 min-w-0",onClick:a,children:[e("div",{className:"text-sm font-medium truncate",children:t}),e("div",{className:"text-xs text-gray-500",children:n})]}),e("div",{onClick:l=>l.stopPropagation(),children:e(fe,{checked:r,onChange:s})})]})}function ue({onClick:t,label:n,state:r,error:s}){const a=()=>{switch(r){case"loading":return e("svg",{className:"w-4 h-4 animate-spin text-blue-400",fill:"none",viewBox:"0 0 24 24",children:[e("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e("path",{className:"opacity-75",fill:"currentColor",d:"m4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]});case"success":return e("svg",{className:"w-4 h-4 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})});case"error":return e("svg",{className:"w-4 h-4 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})});default:return null}};return e("div",{children:[e("button",{onClick:t,disabled:r==="loading",className:`w-full text-left px-3 py-2 rounded-lg text-sm flex items-center justify-between ${(()=>{switch(r){case"success":return"bg-green-800/20 hover:bg-green-700/30 border border-green-600/30";case"error":return"bg-red-800/20 hover:bg-red-700/30 border border-red-600/30";default:return"bg-gray-800 hover:bg-gray-700"}})()}`,children:[e("span",{children:n}),a()]}),r==="error"&&s&&e("div",{className:"mt-1 px-3 py-1 text-xs text-red-400 bg-red-900/20 rounded",children:s})]})}function re({children:t}){return e("div",{className:"space-y-4",children:t})}function E({label:t,children:n}){return e("div",{children:[e("label",{className:"block text-sm text-gray-400 mb-1",children:t}),n]})}function Z({onCancel:t,onDelete:n,submitLabel:r}){return e("div",{className:"flex gap-2 mt-6",children:[n&&e("button",{type:"button",onClick:n,className:"px-4 py-3 bg-red-600/20 text-red-400 rounded-lg hover:bg-red-600/30",children:"Delete"}),e("button",{type:"button",onClick:t,className:"flex-1 px-4 py-3 bg-gray-700 rounded-lg hover:bg-gray-600",children:"Cancel"}),r&&e("button",{type:"submit",className:"flex-1 px-4 py-3 bg-blue-600 rounded-lg hover:bg-blue-500",children:r})]})}function Vt(){const{logs:t,filter:n,loading:r,autoScroll:s,polling:a,load:l,clear:i,changeFilter:c,setAutoScroll:g,startPolling:m,stopPolling:y}=Bt(),o=X(null);z(()=>(l(),m(),()=>y()),[]),z(()=>{s&&o.current&&o.current.scrollIntoView({behavior:"smooth"})},[t,s]);const h={info:"text-blue-400",warn:"text-yellow-400",error:"text-red-400",debug:"text-gray-500"},d={claude:"bg-purple-600/20 text-purple-400",system:"bg-gray-600/20 text-gray-400",container:"bg-blue-600/20 text-blue-400",api:"bg-green-600/20 text-green-400"},p=f=>{try{return new Date(f).toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"})}catch{return f}};return e("div",{className:"flex flex-col h-full",children:[e("div",{className:"p-4 border-b border-gray-700 flex-shrink-0",children:[e("div",{className:"flex items-center justify-between mb-3",children:[e("div",{children:[e("h2",{className:"font-semibold text-gray-300",children:"Logs"}),e("p",{className:"text-xs text-gray-500",children:"Activity and system logs"})]}),e("div",{className:"flex items-center gap-2",children:[e("select",{value:n,onChange:f=>c(f.target.value),className:"text-xs bg-gray-700 rounded px-2 py-1.5 focus:outline-none focus:ring-1 focus:ring-blue-500",children:[e("option",{value:"all",children:"All"}),e("option",{value:"claude",children:"Claude"}),e("option",{value:"system",children:"System"}),e("option",{value:"error",children:"Errors"})]}),e("button",{onClick:()=>l(),disabled:r,className:"p-1.5 bg-gray-700 rounded hover:bg-gray-600 disabled:opacity-50",title:"Refresh",children:e("span",{className:r?"animate-spin inline-block":"",children:"â†»"})}),e("button",{onClick:i,className:"p-1.5 bg-gray-700 rounded hover:bg-gray-600 text-red-400",title:"Clear logs",children:"âœ•"})]})]}),e("div",{className:"flex items-center gap-2 text-xs",children:[e("button",{onClick:a?y:m,className:`flex items-center gap-1 px-2 py-1 rounded ${a?"bg-green-600/20 text-green-400":"bg-gray-700 text-gray-400 hover:bg-gray-600"}`,children:[e("span",{className:`w-2 h-2 rounded-full ${a?"bg-green-400 animate-pulse":"bg-gray-500"}`}),a?"Live":"Paused"]}),e("span",{className:"text-gray-500",children:[t.length," entries"]})]})]}),e("div",{className:"flex-1 overflow-y-auto p-2 space-y-1 font-mono text-xs bg-gray-950",children:[t.length===0?e("div",{className:"text-gray-500 text-center py-8",children:r?"Loading logs...":"No logs yet"}):t.map(f=>e(Kt,{log:f,levelColors:h,sourceColors:d,formatTime:p},f.id)),e("div",{ref:o})]}),e("div",{className:"p-2 border-t border-gray-700 flex items-center justify-between flex-shrink-0",children:[e("label",{className:"flex items-center gap-2 text-xs text-gray-400 cursor-pointer",children:[e("input",{type:"checkbox",checked:s,onChange:f=>g(f.target.checked),className:"rounded bg-gray-700 border-gray-600 text-blue-500 focus:ring-blue-500 focus:ring-offset-0"}),"Auto-scroll"]}),e("span",{className:"text-xs text-gray-500",children:t.length>0&&`Last: ${p(t[t.length-1].timestamp)}`})]})]})}function Kt({log:t,levelColors:n,sourceColors:r,formatTime:s}){return e("div",{className:"flex items-start gap-2 py-1 px-2 hover:bg-gray-800/50 rounded group",children:[e("span",{className:"text-gray-600 flex-shrink-0 w-16",children:s(t.timestamp)}),e("span",{className:`flex-shrink-0 w-12 ${n[t.level]||"text-gray-400"}`,children:["[",t.level.toUpperCase().slice(0,4),"]"]}),e("span",{className:`flex-shrink-0 px-1.5 py-0.5 rounded text-[10px] ${r[t.source]||"bg-gray-600/20 text-gray-400"}`,children:t.source}),e("span",{className:"text-gray-300 break-all flex-1",children:t.message}),t.metadata&&Object.keys(t.metadata).length>0&&e("span",{className:"text-gray-600 opacity-0 group-hover:opacity-100 transition-opacity",title:JSON.stringify(t.metadata,null,2),children:"{ }"})]})}const ee=[{id:1,name:"GET NEXT FEATURE",shortName:"Feature",keywords:["feature_get_next","next feature","getting feature","feature queue"],description:"Fetching next task from queue"},{id:2,name:"PRE-PLANNING",shortName:"Planning",keywords:["skill-discovery","feature_discuss","feature_assumptions","feature_research","add-skill","npx skills"],description:"Discovering skills & clarifying requirements"},{id:3,name:"REFRESH CONTEXT",shortName:"Context",keywords:["task_plan.md","findings.md","progress.md","planning-with-files","Read task_plan"],description:"Loading planning files"},{id:4,name:"EXPLORE CODEBASE",shortName:"Explore",keywords:["aleph_search","aleph_peek","aleph_cite","Grep","Glob","searching","exploring"],description:"Searching and understanding code"},{id:5,name:"IMPLEMENT",shortName:"Implement",keywords:["Write","Edit","writing code","implementing","creating file","editing file"],description:"Writing code and tests"},{id:6,name:"QUALITY CHECK",shortName:"Quality",keywords:["quality_check","feature_verify","npm test","pytest","lint","tsc","type check","running tests"],description:"Running verification suite"},{id:7,name:"MARK COMPLETE",shortName:"Complete",keywords:["feature_mark_passing","aleph_refresh","marking complete","task complete"],description:"Finalizing and committing"},{id:8,name:"COMMIT",shortName:"Commit",keywords:["/commit","git commit","git add","committing","committed"],description:"Committing changes"},{id:9,name:"LEARN",shortName:"Learn",keywords:["/retrospective","extract learnings","saving skill","knowledge extraction"],description:"Extracting reusable knowledge"}];function Qt(){const[t,n]=x(0),[r,s]=x([]),[a,l]=x(!0),[i,c]=x(""),g=X(null),m=X(new Set),y=d=>{const p=d.toLowerCase();for(const f of ee)for(const _ of f.keywords)if(p.includes(_.toLowerCase()))return f.id;return null},o=async()=>{try{const f=(await(await fetch("/api/logs?filter=all&limit=50")).json()).logs||[];for(const _ of f.reverse()){const v=`${_.timestamp}-${_.message}`;if(m.current.has(v))continue;m.current.add(v);const b=y(_.message);b&&b!==t&&(n(b),c(_.message),s(k=>[{timestamp:_.timestamp,stage:b,message:_.message.slice(0,100)},...k].slice(0,20)))}}catch(d){console.error("Failed to fetch workflow logs:",d)}};z(()=>(o(),a&&(g.current=window.setInterval(o,2e3)),()=>{g.current&&clearInterval(g.current)}),[a]);const h=d=>d<t?"completed":d===t?"current":"pending";return e("div",{className:"h-full flex flex-col bg-gray-900",children:[e("div",{className:"p-4 border-b border-gray-700 flex items-center justify-between",children:[e("div",{children:[e("h2",{className:"font-semibold text-gray-300",children:"Workflow Pipeline"}),e("p",{className:"text-xs text-gray-500",children:"Production-ready loop status"})]}),e("button",{onClick:()=>l(!a),className:`px-3 py-1 text-xs rounded-full flex items-center gap-2 ${a?"bg-green-600/30 text-green-400 border border-green-500/50":"bg-gray-700 text-gray-400"}`,children:[e("span",{className:`w-2 h-2 rounded-full ${a?"bg-green-400 animate-pulse":"bg-gray-500"}`}),a?"Live":"Paused"]})]}),e("div",{className:"p-4 border-b border-gray-700",children:e("div",{className:"flex items-center justify-between gap-1 overflow-x-auto pb-2",children:ee.map((d,p)=>{const f=h(d.id);return e("div",{className:"flex items-center",children:[e("div",{className:`flex flex-col items-center min-w-[60px] ${f==="current"?"scale-110":""}`,title:`${d.name}: ${d.description}`,children:[e("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-xs font-bold transition-all ${f==="completed"?"bg-green-600 text-white":f==="current"?"bg-blue-500 text-white ring-2 ring-blue-400 ring-offset-2 ring-offset-gray-900 animate-pulse":"bg-gray-700 text-gray-400"}`,children:f==="completed"?"âœ“":d.id}),e("span",{className:`text-[10px] mt-1 text-center ${f==="current"?"text-blue-400 font-medium":"text-gray-500"}`,children:d.shortName})]}),p<ee.length-1&&e("div",{className:`w-4 h-0.5 mx-0.5 ${f==="completed"?"bg-green-600":"bg-gray-700"}`})]},d.id)})})}),t>0&&e("div",{className:"p-4 border-b border-gray-700 bg-blue-900/20",children:e("div",{className:"flex items-center gap-3",children:[e("div",{className:"w-10 h-10 rounded-full bg-blue-500 flex items-center justify-center text-lg font-bold",children:t}),e("div",{className:"flex-1 min-w-0",children:[e("div",{className:"text-sm font-medium text-blue-400",children:ee[t-1]?.name}),e("div",{className:"text-xs text-gray-400 truncate",children:i||ee[t-1]?.description})]})]})}),e("div",{className:"flex-1 overflow-y-auto p-4",children:[e("h3",{className:"text-xs font-medium text-gray-400 mb-3",children:"Stage Transitions"}),r.length===0?e("div",{className:"text-sm text-gray-500 text-center py-8",children:[e("div",{className:"text-2xl mb-2",children:"ðŸ”„"}),"Waiting for workflow activity...",e("div",{className:"text-xs mt-2",children:"Send a message to Claude to see the pipeline in action"})]}):e("div",{className:"space-y-2",children:r.map((d,p)=>e("div",{className:"p-2 bg-gray-800 rounded-lg text-xs",children:[e("div",{className:"flex items-center gap-2 mb-1",children:[e("span",{className:`px-1.5 py-0.5 rounded text-[10px] font-medium ${d.stage<=3?"bg-purple-600/30 text-purple-400":d.stage<=6?"bg-blue-600/30 text-blue-400":"bg-green-600/30 text-green-400"}`,children:ee[d.stage-1]?.shortName}),e("span",{className:"text-gray-500",children:new Date(d.timestamp).toLocaleTimeString()})]}),e("div",{className:"text-gray-300 truncate",children:d.message})]},p))})]}),e("div",{className:"p-3 border-t border-gray-700 bg-gray-800/50",children:e("div",{className:"flex items-center justify-center gap-4 text-[10px] text-gray-500",children:[e("div",{className:"flex items-center gap-1",children:[e("div",{className:"w-3 h-3 rounded-full bg-green-600"}),e("span",{children:"Completed"})]}),e("div",{className:"flex items-center gap-1",children:[e("div",{className:"w-3 h-3 rounded-full bg-blue-500 animate-pulse"}),e("span",{children:"Current"})]}),e("div",{className:"flex items-center gap-1",children:[e("div",{className:"w-3 h-3 rounded-full bg-gray-700"}),e("span",{children:"Pending"})]})]})})]})}function Xt(){const[t,n]=x("board"),[r,s]=x(!1),[a,l]=x(!1),i=Tt(),c=Lt(),g=$t(),m=Dt(),y=Ot(),o=Ht(),h=Ft();z(()=>{i.refresh(),c.loadHistory(),g.load(),m.loadBranch(),o.loadProjects(),h.refresh(),d();const f=setInterval(i.refresh,1e4),_=setInterval(h.refresh,3e4);return()=>{clearInterval(f),clearInterval(_)}},[]);const d=async()=>{(await y.ping()).summary&&n("chat")},p=f=>{n("chat"),c.sendMessage(`Help me implement: ${f.name}

Description: ${f.description||"None"}

Test cases:
${f.test_cases?.join(`
`)||"None"}`)};return e("div",{className:"bg-gray-900 text-gray-100 min-h-screen flex flex-col",children:[e("div",{className:"md:sticky md:top-0 z-50 flex-shrink-0",children:[e("header",{className:"bg-gray-800 border-b border-gray-700 px-4 py-3",children:e("div",{className:"flex items-center justify-between",children:[e("div",{className:"flex items-center gap-2",children:[e("h1",{className:"text-lg font-bold text-blue-400",children:"âš¡"}),e(Yt,{projects:g.projects,currentProject:g.currentProject,managedProjects:o.managedProjects,onSwitch:async f=>{await g.switchProject(f),i.refresh(),c.loadHistory(),m.loadBranch()},onOpenManaged:o.openProject,onNewProject:()=>s(!0),onStartProject:o.startProject,onStopProject:o.stopProject,onDeleteProject:o.deleteProject,onUpdateProject:o.updateProject})]}),e("div",{className:"flex items-center gap-2",children:[e("span",{className:"text-xs text-gray-400 hidden sm:inline",children:i.board?.stats?`${i.board.stats.passing}/${i.board.stats.total} complete (${i.board.stats.progress_percent}%)`:"Loading..."}),e("button",{onClick:()=>l(!0),className:`p-2 rounded-lg text-sm flex items-center gap-1 ${h.health?.status==="healthy"?"bg-green-600/20 text-green-400 hover:bg-green-600/30":h.health?.status==="warning"?"bg-yellow-600/20 text-yellow-400 hover:bg-yellow-600/30":h.health?.status==="critical"?"bg-red-600/20 text-red-400 hover:bg-red-600/30 animate-pulse":"bg-gray-700 text-gray-400 hover:bg-gray-600"}`,title:`System: ${h.health?.status||"loading"}`,children:[e("span",{className:`w-2 h-2 rounded-full ${h.health?.status==="healthy"?"bg-green-400":h.health?.status==="warning"?"bg-yellow-400":h.health?.status==="critical"?"bg-red-400":"bg-gray-400"}`}),e("span",{className:"hidden sm:inline text-xs",children:h.health?`${h.health.memory.percent}%`:"..."})]}),e("button",{onClick:i.refresh,className:"p-2 bg-gray-700 rounded-lg hover:bg-gray-600 active:bg-gray-500 text-sm",children:"â†»"})]})]})}),e("div",{className:"md:hidden flex border-b border-gray-700 bg-gray-800 flex-shrink-0",children:[e(W,{active:t==="board",onClick:()=>n("board"),label:"Board"}),e(W,{active:t==="chat",onClick:()=>n("chat"),label:"Claude"}),e(W,{active:t==="flow",onClick:()=>n("flow"),label:"Flow"}),e(W,{active:t==="tools",onClick:()=>n("tools"),label:"Tools"}),e(W,{active:t==="logs",onClick:()=>n("logs"),label:"Logs"})]}),e("div",{className:"hidden md:flex border-b border-gray-700 bg-gray-800 justify-center",children:[e(W,{active:t==="board",onClick:()=>n("board"),label:"Board"}),e(W,{active:t==="chat",onClick:()=>n("chat"),label:"Claude"}),e(W,{active:t==="flow",onClick:()=>n("flow"),label:"Flow"}),e(W,{active:t==="tools",onClick:()=>n("tools"),label:"Tools"}),e(W,{active:t==="logs",onClick:()=>n("logs"),label:"Logs"})]})]}),e("div",{className:"flex flex-1 overflow-hidden",children:[e("main",{className:`flex-1 flex flex-col overflow-hidden ${t!=="board"?"hidden":"flex"}`,children:e(zt,{data:i.board,onMoveTask:i.moveTask,onAddTask:i.createTask,onWorkOnTask:p})}),e("aside",{className:`w-full flex-1 bg-gray-900 flex-col h-full ${t!=="chat"?"hidden":"flex"}`,children:e(qt,{messages:c.messages,loading:c.loading,branch:m.branch,onSend:c.sendMessage,onStop:c.stopGeneration,onClear:c.clearHistory,onShowAddTask:()=>n("board"),isVisible:t==="chat"})}),e("aside",{className:`w-full flex-1 bg-gray-900 flex-col h-full overflow-y-auto ${t!=="tools"?"hidden":"flex"}`,children:e(Jt,{})}),e("aside",{className:`w-full flex-1 bg-gray-900 flex-col h-full ${t!=="logs"?"hidden":"flex"}`,children:e(Vt,{})}),e("aside",{className:`w-full flex-1 bg-gray-900 flex-col h-full ${t!=="flow"?"hidden":"flex"}`,children:e(Qt,{})})]}),e(Zt,{isOpen:r,onClose:()=>s(!1),onCreate:async(f,_)=>{const v=await o.createProject(f,_);v.success&&v.project&&o.openProject(v.project.id)}}),e(en,{isOpen:a,onClose:()=>l(!1),health:h.health,onRefresh:h.refresh})]})}function Yt({projects:t,currentProject:n,managedProjects:r,onSwitch:s,onOpenManaged:a,onNewProject:l,onStartProject:i,onStopProject:c,onDeleteProject:g,onUpdateProject:m}){const[y,o]=x(!1),[h,d]=x(null);return e("div",{className:"relative",children:[e("button",{onClick:()=>o(!y),className:"flex items-center gap-1 px-2 py-1 bg-gray-700 rounded-lg hover:bg-gray-600 text-sm",children:[e("span",{children:n||"vibes"}),e("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),y&&e("div",{className:"absolute left-0 mt-1 w-64 bg-gray-800 border border-gray-700 rounded-lg shadow-lg z-50",children:e("div",{className:"py-1 max-h-80 overflow-y-auto",children:[e("div",{className:"px-3 py-1 text-xs text-gray-500 uppercase",children:"Current"}),t.map(p=>e("button",{onClick:()=>{s(p.path),o(!1)},className:`w-full text-left px-3 py-2 hover:bg-gray-700 text-sm ${p.current?"text-blue-400":""}`,children:[p.current&&e("span",{className:"mr-1",children:"â—"}),p.name]},p.path)),r.length>0&&e(V,{children:[e("div",{className:"border-t border-gray-700 my-1"}),e("div",{className:"px-3 py-1 text-xs text-gray-500 uppercase",children:"Isolated Projects"}),r.map(p=>e("div",{className:"px-3 py-2 hover:bg-gray-700 text-sm",children:[e("div",{className:"flex items-center justify-between mb-1",children:[e("button",{onClick:()=>{a(p.id),o(!1)},className:"text-left flex-1 truncate hover:text-blue-400",children:p.name}),e("span",{className:`text-xs px-1.5 py-0.5 rounded ${p.container_status==="running"?"bg-green-600/20 text-green-400":"bg-gray-600/20 text-gray-400"}`,children:p.container_status})]}),e("div",{className:"flex items-center gap-1",children:[p.container_status==="running"?e("button",{onClick:f=>{f.stopPropagation(),c(p.id)},className:"p-1 text-yellow-400 hover:bg-yellow-400/20 rounded",title:"Stop",children:e("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:e("path",{d:"M6 4h4v16H6V4zm8 0h4v16h-4V4z"})})}):e("button",{onClick:f=>{f.stopPropagation(),i(p.id)},className:"p-1 text-green-400 hover:bg-green-400/20 rounded",title:"Start",children:e("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:e("path",{d:"M8 5v14l11-7z"})})}),e("button",{onClick:f=>{f.stopPropagation(),a(p.id)},className:"p-1 text-blue-400 hover:bg-blue-400/20 rounded",title:"Open",children:e("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})}),e("button",{onClick:f=>{f.stopPropagation(),d({id:p.id,name:p.name,git_url:p.git_url||""})},className:"p-1 text-gray-400 hover:bg-gray-400/20 rounded",title:"Edit",children:e("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),e("button",{onClick:f=>{f.stopPropagation(),confirm(`Delete project "${p.name}"?`)&&g(p.id)},className:"p-1 text-red-400 hover:bg-red-400/20 rounded",title:"Delete",children:e("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},p.id))]}),e("div",{className:"border-t border-gray-700 my-1"}),e("button",{onClick:()=>{l(),o(!1)},className:"w-full text-left px-3 py-2 hover:bg-gray-700 text-sm text-blue-400 flex items-center gap-2",children:[e("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"New Isolated Project"]})]})}),h&&e("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:()=>d(null),children:e("div",{className:"bg-gray-800 rounded-lg p-4 w-80 max-w-[90vw]",onClick:p=>p.stopPropagation(),children:[e("h3",{className:"text-lg font-medium mb-4",children:"Edit Project"}),e("div",{className:"space-y-3",children:[e("div",{children:[e("label",{className:"block text-sm text-gray-400 mb-1",children:"Name"}),e("input",{type:"text",value:h.name,onInput:p=>d({...h,name:p.target.value}),className:"w-full bg-gray-700 rounded px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e("div",{children:[e("label",{className:"block text-sm text-gray-400 mb-1",children:"Git URL"}),e("input",{type:"text",value:h.git_url,onInput:p=>d({...h,git_url:p.target.value}),className:"w-full bg-gray-700 rounded px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"https://github.com/..."})]}),e("div",{className:"flex gap-2 pt-2",children:[e("button",{onClick:()=>d(null),className:"flex-1 px-3 py-2 bg-gray-700 rounded text-sm hover:bg-gray-600",children:"Cancel"}),e("button",{onClick:()=>{m(h.id,{name:h.name,git_url:h.git_url}),d(null)},className:"flex-1 px-3 py-2 bg-blue-600 rounded text-sm hover:bg-blue-500",children:"Save"})]})]})]})})]})}function Zt({isOpen:t,onClose:n,onCreate:r}){const[s,a]=x(""),[l,i]=x(""),[c,g]=x(!1),[m,y]=x(""),o=async()=>{if(!s.trim()){y("Project name is required");return}g(!0),y("");try{await r(s.trim(),l.trim()||void 0),a(""),i(""),n()}catch(h){y(h.message)}finally{g(!1)}};return t?e(B,{isOpen:t,onClose:n,title:"New Isolated Project",children:e("div",{className:"space-y-4",children:[e("p",{className:"text-sm text-gray-400",children:"Create a new project in its own isolated Docker container."}),e("div",{children:[e("label",{className:"block text-sm font-medium mb-1",children:"Project Name"}),e("input",{type:"text",value:s,onInput:h=>a(h.target.value),placeholder:"my-awesome-project",className:"w-full bg-gray-700 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e("div",{children:[e("label",{className:"block text-sm font-medium mb-1",children:"Git URL (optional)"}),e("input",{type:"text",value:l,onInput:h=>i(h.target.value),placeholder:"https://github.com/user/repo.git",className:"w-full bg-gray-700 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"}),e("p",{className:"text-xs text-gray-500 mt-1",children:"Leave empty to create a blank project"})]}),m&&e("div",{className:"text-sm text-red-400 bg-red-400/10 rounded-lg px-3 py-2",children:m}),e("div",{className:"flex gap-2 justify-end",children:[e("button",{onClick:n,className:"px-4 py-2 text-sm bg-gray-700 rounded-lg hover:bg-gray-600",children:"Cancel"}),e("button",{onClick:o,disabled:c,className:"px-4 py-2 text-sm bg-blue-600 rounded-lg hover:bg-blue-500 disabled:opacity-50",children:c?"Creating...":"Create Project"})]})]})}):null}function en({isOpen:t,onClose:n,health:r,onRefresh:s}){if(!t)return null;const a={healthy:"text-green-400",warning:"text-yellow-400",critical:"text-red-400",error:"text-red-400"},l=({percent:i,color:c})=>e("div",{className:"w-full bg-gray-700 rounded-full h-2",children:e("div",{className:`h-2 rounded-full ${c}`,style:{width:`${Math.min(i,100)}%`}})});return e(B,{isOpen:t,onClose:n,title:"System Health",children:e("div",{className:"space-y-4",children:r?e(V,{children:[e("div",{className:"flex items-center justify-between",children:[e("span",{className:`text-lg font-bold ${a[r.status]}`,children:r.status.toUpperCase()}),e("button",{onClick:s,className:"text-xs text-gray-400 hover:text-white",children:"Refresh"})]}),r.warnings.length>0&&e("div",{className:"bg-yellow-600/10 border border-yellow-600/30 rounded-lg p-3",children:[e("div",{className:"text-yellow-400 text-sm font-medium mb-1",children:"Warnings"}),r.warnings.map((i,c)=>e("div",{className:"text-yellow-300/80 text-xs",children:i},c))]}),e("div",{children:[e("div",{className:"flex justify-between text-sm mb-1",children:[e("span",{children:"CPU"}),e("span",{className:"text-gray-400",children:[r.cpu.percent,"% (",r.cpu.cores," cores)"]})]}),e(l,{percent:r.cpu.percent,color:r.cpu.percent>80?"bg-red-500":r.cpu.percent>60?"bg-yellow-500":"bg-green-500"}),e("div",{className:"text-xs text-gray-500 mt-1",children:["Load: ",r.cpu.load_1m," / ",r.cpu.load_5m," / ",r.cpu.load_15m]})]}),e("div",{children:[e("div",{className:"flex justify-between text-sm mb-1",children:[e("span",{children:"Memory"}),e("span",{className:"text-gray-400",children:[r.memory.used_gb,"GB / ",r.memory.total_gb,"GB (",r.memory.percent,"%)"]})]}),e(l,{percent:r.memory.percent,color:r.memory.percent>85?"bg-red-500":r.memory.percent>70?"bg-yellow-500":"bg-green-500"})]}),e("div",{children:[e("div",{className:"flex justify-between text-sm mb-1",children:[e("span",{children:"Disk"}),e("span",{className:"text-gray-400",children:[r.disk.used_gb,"GB / ",r.disk.total_gb,"GB (",r.disk.percent,"%)"]})]}),e(l,{percent:r.disk.percent,color:r.disk.percent>90?"bg-red-500":r.disk.percent>80?"bg-yellow-500":"bg-green-500"})]}),e("div",{children:[e("div",{className:"flex justify-between text-sm mb-2",children:[e("span",{children:"Containers"}),e("span",{className:"text-gray-400",children:[r.containers.running," / ",r.containers.total," running"]})]}),e("div",{className:"space-y-1 max-h-32 overflow-y-auto",children:r.containers.list.map((i,c)=>e("div",{className:"flex items-center justify-between text-xs bg-gray-800 rounded px-2 py-1",children:[e("span",{className:"truncate",children:i.name}),e("span",{className:`px-1.5 py-0.5 rounded ${i.status==="running"?"bg-green-600/20 text-green-400":"bg-gray-600/20 text-gray-400"}`,children:i.status})]},c))})]}),e("div",{className:"text-xs text-gray-500 text-center",children:["Last updated: ",new Date(r.timestamp).toLocaleTimeString()]})]}):e("div",{className:"text-center py-4 text-gray-400",children:"Loading..."})})})}function W({active:t,onClick:n,label:r}){return e("button",{onClick:n,className:`flex-1 py-3 text-sm font-medium text-center ${t?"tab-active text-blue-400":"text-gray-400"}`,children:r})}wt(e(Xt,{}),document.getElementById("app"));
